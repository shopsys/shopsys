language: php

php:
    - 5.6
    - 7.0
    - 7.1
    - 7.2
    - 7.3

cache:
    directories:
        - ~/.composer/cache

matrix:
    include:
        -   php: 5.6
            env: DEPENDENCIES="--prefer-lowest --prefer-stable"
        -   php: 7.1
            env: DEPENDENCIES="--prefer-lowest --prefer-stable"
        -   php: 7.1
            env: CHECK_STANDARDS="true"

install:
    - if [[ "$CHECK_STANDARDS" = "true" ]]; then composer require --dev shopsys/coding-standards:dev-master; fi
    - travis_retry composer update $DEPENDENCIES

script:
    - php vendor/bin/parallel-lint ./src ./tests
    - php vendor/bin/phpunit tests
    - if [[ "$CHECK_STANDARDS" = "true" ]]; then php vendor/bin/ecs check --verbose ./src ./tests; fi
