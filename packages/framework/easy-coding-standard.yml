imports:
    - { resource: 'vendor/shopsys/coding-standards/easy-coding-standard.yml', ignore_errors: true  }

services:
    # this package is meant to be extensible using class inheritance, so we want to avoid private visibilities in these namespaces
    forbidden_private_visibility_fixer.framework:
        class: Shopsys\CodingStandards\CsFixer\ForbiddenPrivateVisibilityFixer
        calls:
            -   method: configure
                arguments:
                    -   analyzed_namespaces:
                            - Shopsys\FrameworkBundle\Model
                            - Shopsys\FrameworkBundle\Component
                            - Shopsys\FrameworkBundle\Controller
                            - Shopsys\FrameworkBundle\Form\Admin\AdvancedSearch
                            - Shopsys\FrameworkBundle\Form\Constraints
                            - Shopsys\FrameworkBundle\Form\Transformer
                            - Shopsys\FrameworkBundle\Twig

    Shopsys\CodingStandards\Sniffs\ForceLateStaticBindingForProtectedConstantsSniff: ~

    # @deprecated This will be moved from project-base to coding-standards package in next major version
    SlevomatCodingStandard\Sniffs\Operators\DisallowEqualOperatorsSniff: ~

parameters:
    sets:
        - 'psr12'
    skip:
        ObjectCalisthenics\Sniffs\Files\FunctionLengthSniff:
            - '*/src/Controller/Admin/DefaultController.php'
            - '*/src/Form/Admin/*/*FormType.php'
            - '*/src/Migrations/Version*.php'
            - '*/src/Model/AdminNavigation/SideMenuBuilder.php'
            - '*/src/Model/Order/Preview/OrderPreviewCalculation.php'
            - '*/src/Model/Product/ProductVisibilityRepository.php'
            - '*/src/Model/Product/Search/FilterQuery.php'
            - '*/src/Controller/Admin/AdministratorController.php'
            - '*/tests/Unit/Model/Customer/CustomerUserUpdateDataFactoryTest.php'
            - '*/tests/Unit/Component/Domain/DomainDataCreatorTest.php'
            - '*/tests/Unit/Component/Image/ImageLocatorTest.php'
            - '*/tests/Unit/Component/Image/Config/ImageConfigLoaderTest.php'
            - '*/tests/Unit/Component/Image/Config/ImageConfigTest.php'
            - '*/tests/Unit/Model/Category/CategoryNestedSetCalculatorTest.php'
            - '*/tests/Unit/Model/Payment/PaymentPriceCalculationTest.php'
            - '*/src/Form/Constraints/FileAbstractFilesystemValidator.php'

        ObjectCalisthenics\Sniffs\Metrics\PropertyPerClassLimitSniff:
            - '*/src/Model/Order/Order.php'
            - '*/src/Model/Order/OrderData.php'
            - '*/src/Model/Product/Product.php'
            - '*/src/Model/Product/ProductData.php'

        ObjectCalisthenics\Sniffs\Files\ClassTraitAndInterfaceLengthSniff:
            - '*/src/Form/Admin/Product/ProductFormType.php'
            - '*/src/Command/TranslationReplaceSourceCommand.php'
            - '*/src/Component/Grid/Grid.php'
            - '*/src/Model/Order/Order.php'
            - '*/src/Model/Order/OrderFacade.php'
            - '*/src/Model/Product/Product.php'
            - '*/src/Model/Product/ProductRepository.php'
            - '*/src/Model/Product/Elasticsearch/ProductExportRepository.php'
            - '*/tests/Test/Codeception/ActorInterface.php'
            - '*/tests/Unit/Component/Money/MoneyTest.php'
            - '*/src/Model/Product/Search/FilterQuery.php'
            - '*/src/Model/Category/CategoryFacade.php'
            - '*/src/Model/Category/CategoryRepository.php'
            - '*/src/Model/Product/ProductFacade.php'

        PHP_CodeSniffer\Standards\Generic\Sniffs\CodeAnalysis\EmptyStatementSniff.DetectedWhile:
            - '*/src/Model/Product/Availability/ProductAvailabilityRecalculator.php'
            - '*/src/Model/Product/Pricing/ProductPriceRecalculator.php'

        PHP_CodeSniffer\Standards\Generic\Sniffs\NamingConventions\CamelCapsFunctionNameSniff:
            # public methods in the parent class \Doctrine\DBAL\Types\Type are not in camel case format
            - '*/src/Component/Doctrine/MoneyType.php'
            # public methods in the autogenerated AcceptanceTesterActions are not in camel case format
            - '*/tests/Test/Codeception/ActorInterface.php'
            - '*/src/Component/EntityExtension/QueryBuilder.php'

        Shopsys\CodingStandards\CsFixer\ForbiddenDumpFixer:
            # this template is used only in dev environment
            - '*/src/Resources/views/Debug/Elasticsearch/template.html.twig'

        Shopsys\CodingStandards\Sniffs\ObjectIsCreatedByFactorySniff:
            - '*/tests/*'
            # class that is extended from DomainFactory
            - '*/src/Component/Domain/DomainFactoryOverwritingDomainUrl.php'
            - '*/src/DependencyInjection/Compiler/RegisterExtendedEntitiesCompilerPass.php'
            # class that is used by OrderPreviewFactory to create OrderPreview
            - '*/src/Model/Order/Preview/OrderPreviewCalculation.php'
            # class ClassMetadata is created directly as it's later filled with data from parent entity
            - '*/src/Component/EntityExtension/EntityExtensionSubscriber.php'

        Shopsys\CodingStandards\Sniffs\ForbiddenDumpSniff:
            - '*/src/Component/DateTimeHelper/Exception/CannotParseDateTimeException.php'
            - '*/src/Component/Doctrine/Cache/PermanentPhpFileCache.php'
            - '*/src/Twig/VarDumperExtension.php'
            - '*/src/Resources/views/Migration/migration.php.twig'

        Shopsys\CodingStandards\Sniffs\ValidVariableNameSniff:
            # parameter names in the autogenerated AcceptanceTesterActions are not in camel case format
            - '*/tests/Test/Codeception/ActorInterface.php'

        PHP_CodeSniffer\Standards\PSR2\Sniffs\Methods\MethodDeclarationSniff.Underscore:
            - '*/src/Component/Filesystem/Flysystem/VolumeDriver.php'

        PHP_CodeSniffer\Standards\Generic\Sniffs\Metrics\CyclomaticComplexitySniff.MaxExceeded:
            - '*/src/Form/Constraints/FileAbstractFilesystemValidator.php'
            - '*/src/Model/Product/Search/ProductElasticsearchConverter.php'

        # allow empty "catch (Exception $exception) { }"
        PHP_CodeSniffer\Standards\Generic\Sniffs\CodeAnalysis\EmptyStatementSniff.DetectedCatch:
            - '*/src/Component/Elasticsearch/Debug/ElasticsearchTracer.php'

        SlevomatCodingStandard\Sniffs\Classes\ParentCallSpacingSniff.IncorrectLinesCountBeforeControlStructure:
            - '*/src/Component/Filesystem/Flysystem/VolumeDriver.php'

        SlevomatCodingStandard\Sniffs\ControlStructures\DisallowEmptySniff.DisallowedEmpty:
            - '*/src/Component/Filesystem/Flysystem/VolumeDriver.php'
            - '*/src/Model/AdminNavigation/RoutingExtension.php'

        SlevomatCodingStandard\Sniffs\Variables\UnusedVariableSniff:
            # FormInterface is used as an argument to foreach with unused iterated value
            - 'packages/framework/src/Component/Form/ResizeFormListener.php'
