#### Movement of features from project-base to packages

-   in this version, there are quite a lot of features that have been moved from `project-base` to the packages, mostly to the `framework` and the `frontend-api` package
-   each section in the upgrade guide contains a link to the `project-base` diff and besides the particular upgrade instructions, there is also a list of the moved features you should be aware of (if there are any)
-   if your project was originally not developed from the Commerce Cloud version, or it was developed on a version lower than `v13.0.0`, these feature movements should not affect you during the upgrade
-   otherwise, you might need to adjust your project to the changes:
    -   if you had no custom changes in the moved features, you should be fine, you can safely remove the features from your project and use the ones from the packages (project-base diff in each section will help you with that)
    -   if you had custom changes in the moved features, you will need to adjust your project to the changes
        -   you should remove everything that was not modified in your project and keep just the custom changes using the recommended ways of the [framework extensibility](https://docs.shopsys.com/en/latest/extensibility/)
    -   one way or another, you should pay a special attention to the database migrations that were added with the feature movement. If they suit your needs, you should keep them and remove the original migrations from your project, otherwise, you should skip the newly added migrations.

## [Upgrade from v14.0.0 to v15.0.0-dev](https://github.com/shopsys/shopsys/compare/v14.0.0...15.0)

#### fix promo code mass generation ([#3039](https://github.com/shopsys/shopsys/pull/3039))

-   see #project-base-diff to update your project

#### fix display advert in categories ([#3040](https://github.com/shopsys/shopsys/pull/3040))

-   see #project-base-diff to update your project

#### remove unused order flow ([#3046](https://github.com/shopsys/shopsys/pull/3046))

-   class `Shopsys\FrameworkBundle\Model\Order\OrderFlowFacade` was removed
-   class `Shopsys\FrameworkBundle\Model\Order\OrderFlowFactoryInterface` was removed
-   constructor `Shopsys\FrameworkBundle\Model\Security\FrontLogoutHandler` changed its interface:
    ```diff
        public function __construct(
            protected readonly RouterInterface $router,
    -       protected readonly OrderFlowFacade $orderFlowFacade,
    ```
-   constructor `Shopsys\FrameworkBundle\Model\Security\LoginListener` changed its interface:
    ```diff
        public function __construct(
            protected readonly EntityManagerInterface $em,
    -       protected readonly OrderFlowFacade $orderFlowFacade,
            protected readonly AdministratorActivityFacade $administratorActivityFacade,
    ```
-   see #project-base-diff to update your project

#### Added check vulnerabilities for javascripts in storefront ([#2993](https://github.com/shopsys/shopsys/pull/2993))

-   see #project-base-diff to update your project

#### remove deprecated properties from product entity ([#3027](https://github.com/shopsys/shopsys/pull/3027))

-   the following features were removed altogether in favor of `ProductAvailabilityFacade` functionality
    -   `Product::$outOfStockAction`
    -   `Product::$outOfStockAvailability`
    -   `Product::$stockQuantity`
    -   `Product::$usingStock`
    -   `Product::$availability`
    -   `Availability` entity with all the related logic (see `Shopsys\FrameworkBundle\Model\Product\Availability` namespace)
-   `Shopsys\FrameworkBundle\Controller\Admin\DefaultController::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       protected readonly AvailabilityFacade $availabilityFacade,
    ```
-   `Shopsys\FrameworkBundle\Controller\Admin\ProductController::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       protected readonly AvailabilityFacade $availabilityFacade,
    ```
-   `assets/js/admin/validation/form/validationProduct.js` was removed
-   `Shopsys\FrameworkBundle\Model\AdvancedSearch\AdvancedSearchFilterInterface::OPERATOR_IS_USED` and `OPERATOR_IS_NOT_USED` constants were removed
-   `Shopsys\FrameworkBundle\Model\AdvancedSearch\Filter\ProductStockFilter` class was removed
-   `Shopsys\FrameworkBundle\Model\AdvancedSearch\ProductAdvancedSearchConfig::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       ProductStockFilter $productStockFilter,
            // ..
    ```
-   `Shopsys\FrameworkBundle\Model\Module\ModuleList::PRODUCT_STOCK_CALCULATIONS` constant was removed
-   `Shopsys\FrameworkBundle\Model\Order\Item\OrderProductFacade` class was removed
-   `Shopsys\FrameworkBundle\Model\Order\OrderFacade::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       protected readonly OrderProductFacade $orderProductFacade,
    ```
-   `Shopsys\FrameworkBundle\Model\Product\Product::OUT_OF_STOCK_ACTION_SET_ALTERNATE_AVAILABILITY`, `OUT_OF_STOCK_ACTION_EXCLUDE_FROM_SALE`, and `OUT_OF_STOCK_ACTION_HIDE` constants were removed
-   `Shopsys\FrameworkBundle\Model\ProductProductDataFactory::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       protected readonly AvailabilityFacade $availabilityFacade,
    ```
-   `Shopsys\FrameworkBundle\Model\Product\ProductFactory::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       protected readonly ProductAvailabilityCalculation $productAvailabilityCalculation,
    ```
-   `Shopsys\FrameworkBundle\Model\Product\ProductRepository::getAllSellableUsingStockInStockQueryBuilder()` method was removed
-   `Shopsys\FrontendApiBundle\Model\Order\PlaceOrderFacade::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       protected readonly OrderProductFacade $orderProductFacade,
    ```
-   `Shopsys\FrontendApiBundle\Model\Resolver\Products\DataMapper\ProductArrayFieldMapper::isUsingStock()` method was removed
-   FE API: `isUsingStock` field was removed from `ProductDecorator.types`
-   double-check the `Shopsys\FrameworkBundle\Migrations\Version20240206145944` migration to ensure it does not break your application
-   see #project-base-diff to update your project

#### set version of `friendsofphp/php-cs-fixer` >= `3.50` as conflicting to resolve problems in tests ([#3042](https://github.com/shopsys/shopsys/pull/3042))

-   see #project-base-diff to update your project

#### fix removing promo code from cart ([#3043](https://github.com/shopsys/shopsys/pull/3043))

-   see #project-base-diff to update your project

#### add doctrine backtrace collecting ([#3055](https://github.com/shopsys/shopsys/pull/3055))

-   see #project-base-diff to update your project

#### remove unused front order classes ([#3054](https://github.com/shopsys/shopsys/pull/3054))

-   class `Shopsys\FrameworkBundle\Model\Order\FrontOrderData` was removed
-   class `Shopsys\FrameworkBundle\Model\Order\FrontOrderDataMapper` was removed
-   class `Shopsys\FrameworkBundle\Model\Order\OrderDataMapper` was removed
-   `Shopsys\FrameworkBundle\Model\Order\OrderFacade`:
    -   constructor `__construct()` changed its interface:
        ```diff
            public function __construct(
                // ...
        -       protected readonly FrontOrderDataMapper $frontOrderDataMapper,
                // ...
        ```
    -   method `createOrderFromFront()` was removed
    -   method `prefillFrontOrderData()` was removed
-   see #project-base-diff to update your project
-   fix a problem with deployment for the same commit ([#3061](https://github.com/shopsys/shopsys/pull/3061))
    -   see #project-base-diff to update your project

#### add rounding and discount as a separate order item types ([#3056](https://github.com/shopsys/shopsys/pull/3056))

-   order items now have proper types for rounding and discount, see `OrderItem::TYPE_*` constants
-   interface `Shopsys\FrameworkBundle\Model\Order\Item\OrderItemFactoryInterface` was removed, use `Shopsys\FrameworkBundle\Model\Order\Item\OrderItemFactory`, or your custom implementation instead
-   interface `Shopsys\FrameworkBundle\Model\Order\Item\OrderItemDataFactoryInterface` was removed, use `Shopsys\FrameworkBundle\Model\Order\Item\OrderItemDataFactory`, or your custom implementation instead
-   interface `Shopsys\FrameworkBundle\Model\Order\OrderDataFactoryInterface` was removed, use `Shopsys\FrameworkBundle\Model\Order\OrderDataFactory`, or your custom implementation instead
-   the following classes are now strictly typed:
    -   `Shopsys\FrameworkBundle\Controller\Admin\OrderController`
    -   `Shopsys\FrameworkBundle\Model\Order\Item\OrderItem`
    -   `Shopsys\FrameworkBundle\Model\Order\Item\OrderItemFacade`
    -   `Shopsys\FrameworkBundle\Model\Order\Item\Order`
    -   `Shopsys\FrameworkBundle\Model\Order\Item\OrderDataFactory`
    -   `Shopsys\FrameworkBundle\Model\Order\Item\OrderFacade`
-   constructor `Shopsys\FrameworkBundle\Model\Order\Item\OrderItemFacade::__construct()` was changed:
    ```diff
        public function __construct(
            // ...
    +       protected readonly OrderItemDataFactory $orderItemDataFactory,
    ```
-   `Shopsys\FrameworkBundle\Model\Order\Item\OrderItemFactory`:
    -   method `createProduct()` changed its interface:
        ```diff
            public function createProduct(
        +       OrderItemData $orderItemData,
                Order $order,
        -       string $name,
        -       Price $price,
        -       string $vatPercent,
        -       int $quantity,
        -       ?string $unitName,
        -       ?string $catnum,
        -       ?Product $product = null,
        +       ?Product $product,
            ): OrderItem {
        ```
    -   method `createPayment()` changed its interface:
        ```diff
            public function createPayment(
        +       OrderItemData $orderItemData,
                Order $order,
        -       string $name,
        -       Price $price,
        -       string $vatPercent,
        -       int $quantity,
                Payment $payment,
            ): OrderItem {
        ```
    -   method `createTransport()` changed its interface:
        ```diff
            public function createTransport(
        +       OrderItemData $orderItemData,
                Order $order,
        -       string $name,
        -       Price $price,
        -       string $vatPercent,
        -       int $quantity,
                Transport $transport,
            ): OrderItem {
        ```
-   `Shopsys\FrameworkBundle\Model\Order\Order`:
    -   method `getPaymentName()` was removed, use `getPaymentItem()->getName()` instead
    -   method `getOrderPayment()` was removed, use `getPaymentItem()` instead
    -   method `getTransportName()` was removed, use `getTransportItem()->getName()` instead
    -   method `getOrderTransport()` was removed, use `getTransportItem()` instead
    -   method `getTransportAndPaymentItems()` was removed, use `getTransportItem()` and `getPaymentItem()` instead
    -   method `getTransportAndPaymentPrice()` was removed
    -   method `getItemById()` was removed
    -   method `getProductItemsCount()` was removed
-   see #project-base-diff to update your project

#### changed link URL for Catalog navigation element ([#3057](https://github.com/shopsys/shopsys/pull/3057))

-   see #project-base-diff to update your project

#### add security headers for more safety in local development ([#3050](https://github.com/shopsys/shopsys/pull/3050))

-   see #project-base-diff to update your project

### added indexes for columns which were used for order by and where in entites TransferIssue and CronModuleRun ([#3048](https://github.com/shopsys/shopsys/pull/3048))

-   see #project-base-diff to update your project

#### fix persist on null object in create delivery address ([#2350](https://github.com/shopsys/shopsys/pull/2350))

-   `Shopsys\FrameworkBundle\Model\Customer\DeliveryAddressFacade` class has changed:
    -   `create` method was renamed to `createIfAddressFilled` and return type was changed to `?DeliveryAddress`
-   see #project-base-diff to update your project

#### remove UUIDs pools and replace them by UUID generated by entity datas to avoid UUIDs changes in the future ([#3075](https://github.com/shopsys/shopsys/pull/3075))

-   see #project-base-diff to update your project

#### product recalculations scoping ([#3051](https://github.com/shopsys/shopsys/pull/3051))

-   `Shopsys\FrameworkBundle\Command\DispatchRecalculationMessageCommand` class was changed:
    -   `executeAll()` method changed its interface:
        ```diff
        -   public function executeAll(SymfonyStyle $symfonyStyle): int
        +   public function executeAll(SymfonyStyle $symfonyStyle, array $scopes): int
        ```
    -   `executeIds()` method changed its interface:
        ```diff
            public function executeIds(
                array $productIds,
                SymfonyStyle $symfonyStyle,
                ProductRecalculationPriorityEnumInterface $priority,
        +       array $scopes,
        ```
-   `Shopsys\FrameworkBundle\Component\Elasticsearch\AbstractIndex` class was changed:
    -   `getExportDataForIds()` method changed its interface:
        ```diff
            abstract public function getExportDataForIds(
                int $domainId,
                array $restrictToIds,
        +       array $fields = [],
        ```
    -   `getExportDataForBatch()` method changed its interface:
        ```diff
            abstract public function getExportDataForBatch(
                int $domainId,
                 int $lastProcessedId,
                 int $batchSize,
        +        array $fields = [],
        ```
-   `Shopsys\FrameworkBundle\Component\Elasticsearch\IndexFacade` class was changed:
    -   `exportIds()` method changed its interface:
        ```diff
            public function exportIds(
                AbstractIndex $index,
                IndexDefinition $indexDefinition,
                array $restrictToIds,
        +       array $fields = [],
        ```
-   `Shopsys\FrameworkBundle\Model\Article\Elasticsearch\ArticleIndex` class was changed:
    -   `getExportDataForIds()` method changed its interface:
        ```diff
            public function getExportDataForIds(
                int $domainId,
                array $restrictToIds,
        +       array $fields = [],
        ```
    -   `getExportDataForBatch()` method changed its interface:
        ```diff
            public function getExportDataForBatch(
                int $domainId,
                int $lastProcessedId,
                int $batchSize,
        +       array $fields = [],
        ```
-   `Shopsys\FrameworkBundle\Model\Blog\Article\Elasticsearch\BlogArticleIndex` class was changed:
    -   `getExportDataForIds()` method changed its interface:
        ```diff
            public function getExportDataForIds(
                int $domainId,
                array $restrictToIds,
        +       array $fields = [],
        ```
    -   `getExportDataForBatch()` method changed its interface:
        ```diff
            public function getExportDataForBatch(
                int $domainId,
                int $lastProcessedId,
                int $batchSize,
        +       array $fields = [],
        ```
-   `Shopsys\FrameworkBundle\Model\Product\Elasticsearch\ProductExportRepository` class was changed:
    -   the class now implements `Symfony\Contracts\Service\ResetInterface`
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
                protected readonly HreflangLinksFacade $hreflangLinksFacade,
        +       protected readonly ProductExportFieldProvider $productExportFieldProvider,
        +       protected readonly PricingGroupSettingFacade $pricingGroupSettingFacade,
        +       protected readonly ProductRepository $productRepository,
        +       protected ?array $variantCache = null,
        ```
    -   `getProductsData()` method changed its interface:
        ```diff
            public function getProductsData(
                int $domainId,
                string $locale,
                int $lastProcessedId,
                int $batchSize,
        +       array $fields = [],
        ```
    -   `getProductsDataForIds()` method changed its interface:
        ```diff
            public function getProductsDataForIds(
                int $domainId,
                string $locale,
                array $productIds,
        +       array $fields,
        ```
    -   `extractResult()` method changed its interface:
        ```diff
            protected function extractResult(
                Product $product,
                int $domainId,
                string $locale,
        +       array $fields,
        ```
-   `Shopsys\FrameworkBundle\Model\Product\Elasticsearch\ProductIndex` class was changed:
    -   `getExportDataForIds()` method changed its interface:
        ```diff
            public function getExportDataForIds(
                int $domainId,
                array $restrictToIds,
        +       array $fields = [],
        ```
    -   `getExportDataForBatch()` method changed its interface:
        ```diff
            public function getExportDataForBatch(
                int $domainId,
                int $lastProcessedId,
                int $batchSize,
        +       array $fields = [],
        ```
-   `Shopsys\FrameworkBundle\Model\Product\Recalculation\AbstractProductRecalculationMessage::__construct` changed its interface:
    ```diff
        public function __construct(
            public readonly int $productId,
    +       public readonly array $exportScopes = [],
    ```
-   `Shopsys\FrameworkBundle\Model\Product\Recalculation\ProductRecalculationDispatcher` class was changed:
    -   `dispatchProducts()` method changed its interface:
        ```diff
            public function dispatchProducts(
                array $products,
                ProductRecalculationPriorityEnumInterface $productRecalculationPriorityEnum = ProductRecalculationPriorityEnum::REGULAR,
        +       array $exportScopes = [],
        ```
    -   `dispatchProductIds()` method changed its interface:
        ```diff
            public function dispatchProductIds(
                array $productIds,
                ProductRecalculationPriorityEnumInterface $productRecalculationPriorityEnum = ProductRecalculationPriorityEnum::REGULAR,
        +       array $exportScopes = [],
        ```
    -   `dispatchSingleProductId()` method changed its interface:
        ```diff
            public function dispatchSingleProductId(
                int $productId,
                ProductRecalculationPriorityEnumInterface $productRecalculationPriorityEnum = ProductRecalculationPriorityEnum::REGULAR,
        +       array $exportScopes = [],
        ```
    -   `dispatchAllProducts()` method changed its interface:
        ```diff
            public function dispatchAllProducts(
        +       array $exportScopes = [],
        ```
-   `Shopsys\FrameworkBundle\Model\Product\Recalculation\ProductRecalculationFacade` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
                protected readonly ProductSellingDeniedRecalculator $productSellingDeniedRecalculator,
        +       protected readonly ProductExportScopeConfigFacade $productExportScopeConfigFacade,
        +       protected readonly ProductElasticsearchProvider $productElasticsearchProvider,
        ```
    -   `recalculate()` method changed its interface:
        ```diff
            public function recalculate(
                array $productIds,
        +       array $exportScopesIndexedByProductId,
        ```
-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework package:
    -   product variants cache in `Shopsys\FrameworkBundle\Model\Product\Elasticsearch\ProductExportRepository`
-   see #project-base-diff to update your project

#### update Elasticsearch index files structure ([#2567](https://github.com/shopsys/shopsys/pull/2567))

-   elastic index definition files where sorted by order of columns in `ExportRepository` classes. These are not mandatory changes, and you can decide to skip them.
-   add missing properties and remove unnecessary properties from elastic structure
-   changed indent count for json files. These are not mandatory changes, and you can decide to skip them.
-   see #project-base-diff to update your project

#### rename reserved database function `normalize` to non-reserved name `normalized` ([#3072](https://github.com/shopsys/shopsys/pull/3072))

-   create migration to change `normalize()` function to `normalized()` if you had used it in some indexes, functions, or somewhere else
-   don't forget to rename this function in SQLs in repositories, commands, or somewhere else where is used
-   see #project-base-diff to update your project

#### fix seo pages urls ([#3079](https://github.com/shopsys/shopsys/pull/3079))

-   this change adds migration `Version20240325165512` that changes friendly urls. If you do not want to change friendly urls in your project, add it as skipped migration to `migrations-lock.yaml`

#### make delivery address fields not nullable ([#2494](https://github.com/shopsys/shopsys/pull/2494))

-   class `Shopsys\FrameworkBundle\Form\Admin\Customer\DeliveryAddressFormType` was removed
-   check migration `Version20220725104726` if suits your needs
-   following fields in `Shopsys\FrameworkBundle\Model\Customer\DeliveryAddress` are no longer nullable:
    -   `$firstName`
    -   `$lastName`
    -   `$street`
    -   `$city`
    -   `$postcode`
    -   `$country`
-   see #project-base-diff to update your project

#### restrict limit of requests how many can robot ask from eshop ([#2820](https://github.com/shopsys/shopsys/pull/2820))

-   this change adds migration `Version20230919173422` that adds SEO robot limits to your `robots.txt` file. If you do not want to change it in your project, add it as skipped migration to `migrations-lock.yaml`
-   if you have defined rules for all robots (`User-agent: *`), then you have to manually add these lines to your robots.txt
    ```diff
        User-agent: *
    +   Crawl-delay: 3
    +   Request-rate: 300/1m
    ```
-   see #project-base-diff to update your project

#### apply new coding standards for alphabetical ordering of YAML files ([#2278](https://github.com/shopsys/shopsys/pull/2278))

-   run `php phing yaml-standards-fix` to apply the new coding standards
-   see #project-base-diff to update your project

#### allow open Cypress GUI on Windows with WSL2 ([#3116](https://github.com/shopsys/shopsys/pull/3116))

-   see #project-base-diff to update your project

#### fix friendly URLs ([#3115](https://github.com/shopsys/shopsys/pull/3115))

-   see #project-base-diff to update your project

#### move order and cart related logic from project-base to packages ([#3088](https://github.com/shopsys/shopsys/pull/3088))

-   `Shopsys\FrameworkBundle\Controller\Admin\DefaultController::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    +       protected readonly TransferIssueFacade $transferIssueFacade,
    ```
-   `Shopsys\FrameworkBundle\Controller\Admin\ProductController::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    -       protected readonly ProductDataFactoryInterface $productDataFactory,
    +       protected readonly ProductDataFactory $productDataFactory,
    ```
-   `Shopsys\FrameworkBundle\Controller\Admin\PromoCodeController::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    +       protected readonly PromoCodeMassGeneratedBatchGridFactory $promoCodeMassGeneratedBatchGridFactory,
    ```
-   `Shopsys\FrameworkBundle\Model\Cart\CartFacade` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        -       protected readonly CartWatcherFacade $cartWatcherFacade,
        +       protected readonly ProductAvailabilityFacade $productAvailabilityFacade,
        ```
    -   `addProductToCart()` method was removed, use `addProductToExistingCart()` instead
    -   `changeQuantities()` method was removed, use `addProductToExistingCart()` with properly set parameters (`$isAbsoluteQuantity` and `$quantity`) instead
    -   `deleteCartItem()` method was removed, use `removeItemFromExistingCartByUuid()` instead
    -   `deleteCartOfCurrentCustomerUser()` method was removed, use `deleteCart()` instead
    -   `cleanAdditionalData()` method was removed without replacement
    -   `getCartOfCurrentCustomerUserCreateIfNotExists()` method was removed, use `findCartByCustomerUserIdentifier()` instead
    -   `getQuantifiedProductsOfCurrentCustomer()` method was removed, use `Cart::getQuantifiedProducts()` instead
-   `Shopsys\FrameworkBundle\Model\Cart\Watcher\CartWatcherFacade` class was removed, use `Shopsys\FrontendApiBundle\Model\Cart\CartWatcherFacade` instead
-   `Shopsys\FrameworkBundle\Model\Order\Preview\OrderPreview::__construct` interface has changed:
    ```diff
        public function __construct(
            protected readonly array $quantifiedProductsByIndex,
            protected readonly array $quantifiedItemsPricesByIndex,
            protected readonly array $quantifiedItemsDiscountsByIndex,
            protected readonly Price $productsPrice,
            protected readonly Price $totalPrice,
    +       protected readonly Price $totalPriceDiscount,
    +       protected readonly Price $totalPriceWithoutDiscountTransportAndPayment,
            protected readonly ?Transport $transport = null,
            protected readonly ?Price $transportPrice = null,
            protected readonly ?Payment $payment = null,
            protected readonly ?Price $paymentPrice = null,
            protected readonly ?Price $roundingPrice = null,
    -       $promoCodeDiscountPercent = null,
    +       protected readonly ?string $promoCodeDiscountPercent = null,
    +       protected readonly ?Store $personalPickupStore = null,
    +       protected readonly ?PromoCode $promoCode = null,
    ``
    ```
-   `Shopsys\FrameworkBundle\Model\Order\Preview\OrderPreviewCalculation` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly CurrentPromoCodeFacade $currentPromoCodeFacade,
        ```
    -   `calculatePreview()` method changed its interface:
        ```diff
            public function calculatePreview(
                Currency $currency,
                int $domainId,
                array $quantifiedProducts,
                ?Transport $transport = null,
                ?Payment $payment = null,
                ?CustomerUser $customerUser = null,
                ?string $promoCodeDiscountPercent = null,
        +       ?Store $personalPickupStore = null,
        +       ?PromoCode $promoCode = null,
        ```
-   `Shopsys\FrameworkBundle\Model\Order\Preview\OrderPreviewFactory` class was changed:
    -   `create()` method changed its interface:
        ```diff
            public function create(
                Currency $currency,
        -       $domainId,
        +       int $domainId,
                array $quantifiedProducts,
                ?Transport $transport = null,
                ?Payment $payment = null,
                ?CustomerUser $customerUser = null,
        +       ?string $promoCodeDiscountPercent = null,
        +       ?Store $personalPickupStore = null,
        +       ?PromoCode $promoCode = null,
        +   ): OrderPreview {
        ```
    -   `createForCurrentUser()` method was removed, use `create()` instead
-   `Shopsys\FrameworkBundle\Model\Order\PromoCode\CurrentPromoCodeFacade` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                protected readonly PromoCodeFacade $promoCodeFacade,
        -       protected readonly RequestStack $requestStack,
        +       protected readonly PromoCodeProductRepository $promoCodeProductRepository,
        +       protected readonly Domain $domain,
        +       protected readonly ProductPromoCodeFiller $productPromoCodeFiller,
        +       protected readonly PromoCodeLimitResolver $promoCodeLimitByCartTotalResolver,
        +       protected readonly CurrentCustomerUser $currentCustomerUser,
        +       protected readonly PromoCodePricingGroupRepository $promoCodePricingGroupRepository,
        ```
    -   `PROMO_CODE_SESSION_KEY` constant was removed
    -   `getValidEnteredPromoCodeOrNull()` method was removed, use `getValidatedPromoCode()` instead
    -   `setEnteredPromoCode()` method was removed, use `Cart::applyPromoCode()` instead
    -   `removeEnteredPromoCode()` method was removed, use `Cart::removePromoCodeById()` instead
-   `Shopsys\FrameworkBundle\Model\Order\PromoCode\Grid\PromoCodeGridFactory` class was changed
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                protected readonly EntityManagerInterface $em,
                protected readonly GridFactory $gridFactory,
        +       protected readonly AdminDomainTabsFacade $adminDomainTabsFacade,
        +       protected readonly PromoCodeLimitRepository $promoCodeLimitRepository,
        ```
    -   `create()` method changed its interface:
        ```diff
        -   public function create($withEditButton = false)
        +   public function create(bool $withEditButton = true, ?string $search = null): Grid
        ```
-   `Shopsys\FrameworkBundle\Model\Order\PromoCode\PromoCode::$percent` property (and `getPercent()` method) was removed, use `PromoCodeLimit::$discount` instead
-   `Shopsys\FrameworkBundle\Model\Order\PromoCode\PromoCodeData::$percent` property was removed, use `PromoCodeLimit::$discount` instead
-   `Shopsys\FrameworkBundle\Model\Order\PromoCode\PromoCodeFacade` class was changed:
    -   the methods are now type-hinted
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                protected readonly EntityManagerInterface $em,
                protected readonly PromoCodeRepository $promoCodeRepository,
                protected readonly PromoCodeFactoryInterface $promoCodeFactory,
        +       protected readonly PromoCodeLimitRepository $promoCodeLimitRepository,
        +       protected readonly PromoCodeProductRepository $promoCodeProductRepository,
        +       protected readonly PromoCodeCategoryRepository $promoCodeCategoryRepository,
        +       protected readonly PromoCodeProductFactory $promoCodeProductFactory,
        +       protected readonly PromoCodeCategoryFactory $promoCodeCategoryFactory,
        +       protected readonly PromoCodeBrandRepository $promoCodeBrandRepository,
        +       protected readonly PromoCodeBrandFactory $promoCodeBrandFactory,
        +       protected readonly PromoCodePricingGroupRepository $promoCodePricingGroupRepository,
        +       protected readonly PromoCodePricingGroupFactory $promoCodePricingGroupFactory,
        +       protected readonly PromoCodeFlagRepository $promoCodeFlagRepository,
        +       protected readonly HashGenerator $hashGenerator,
        ```
    -   `findPromoCodeByCode()` method was removed, use `findPromoCodeByCodeAndDomain()` instead
-   `Shopsys\FrameworkBundle\Model\Order\PromoCode\PromoCodeRepository::findByCode()` method was removed, use `findByCodeAndDomainId()` instead
-   `Shopsys\FrameworkBundle\Model\Product\Pricing\QuantifiedProductDiscountCalculation` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        +       protected readonly PromoCodeLimitResolver $promoCodeLimitResolver,
                protected readonly PriceCalculation $priceCalculation,
                protected readonly Rounding $rounding,
        +       protected readonly PromoCodeApplicableProductsTotalPriceCalculator $promoCodeApplicableProductsTotalPriceCalculator,
        ```
    -   `calculateDiscountsRoundedByCurrency()` method was removed, use `calculateDiscountsPerProductRoundedByCurrency()` instead
-   `Shopsys\FrameworkBundle\Model\Product\ProductDataFactoryInterface` interface was removed
-   `Shopsys\FrameworkBundle\Model\Store\StoreIdsToStoresTransformer` class was removed
-   `Shopsys\FrontendApiBundle\Component\Constraints\PaymentCanBeUsed` class was removed
-   `Shopsys\FrontendApiBundle\Component\Constraints\PaymentCanBeUsedValidator` class was removed
-   `Shopsys\FrontendApiBundle\Component\Constraints\PaymentInOrder` class was renamed to `Shopsys\FrontendApiBundle\Component\Constraints\PaymentInExistingOrder`
-   `Shopsys\FrontendApiBundle\Component\Constraints\PaymentInOrderValidator` class was renamed to `Shopsys\FrontendApiBundle\Component\Constraints\PaymentInExistingOrderValidator`
-   `Shopsys\FrontendApiBundle\Component\Constraints\PaymentTransportRelationValidator::__construct` method changed its interface:
    ```diff
        public function __construct(
    -       protected readonly PaymentFacade $paymentFacade,
    -       protected readonly TransportFacade $transportFacade,
    +       protected readonly CurrentCustomerUser $currentCustomerUser,
    +       protected readonly CartApiFacade $cartApiFacade,
    ```
-   `Shopsys\FrontendApiBundle\Component\Constraints\ProductCanBeOrdered` class was removed
-   `Shopsys\FrontendApiBundle\Component\Constraints\ProductCanBeOrderedValidator` class was removed
-   `Shopsys\FrontendApiBundle\Component\Constraints\TransportCanBeUsed` class was removed
-   `Shopsys\FrontendApiBundle\Component\Constraints\TransportCanBeUsedValidator` class was removed
-   `Shopsys\FrontendApiBundle\Model\Order\OrderDataFactory` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
                protected readonly CountryFacade $countryFacade,
                protected readonly ProductFacade $productFacade,
        +       protected readonly StoreFacade $storeFacade,
        ```
    -   `createQuantifiedProductsFromArgument()` method was removed, use `Cart::getQuantifiedProducts()` instead
-   `Shopsys\FrontendApiBundle\Model\Order\PlaceOrderFacade` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
                protected readonly PlacedOrderMessageDispatcher $placedOrderMessageDispatcher,
        +       protected readonly CustomerUserUpdateDataFactory $customerUserUpdateDataFactory,
        +       protected readonly DeliveryAddressDataFactory $deliveryAddressDataFactory,
        +       protected readonly DeliveryAddressFactory $deliveryAddressFactory,
        +       protected readonly NewsletterFacade $newsletterFacade,
        +       protected readonly PromoCodeLimitResolver $promoCodeLimitResolver,
        ```
    -   `placeOrder()` method changed its interface:
        ```diff
            public function placeOrder(
                 OrderData $orderData,
                 array $quantifiedProducts,
        +        ?PromoCode $promoCode = null,
        +        ?DeliveryAddress $deliveryAddress = null,
        + ): Order {
        ```
    -   `createOrderPreview()` method was removed
-   `Shopsys\FrontendApiBundle\Model\Resolver\Transport\TransportsQuery` class was changed:
-   `__construct()` method changed its interface:
    ```diff
        public function __construct(
            protected readonly TransportFacade $transportFacade,
    -       protected readonly PaymentFacade $paymentFacade,
    +       protected readonly CartApiFacade $cartApiFacade,
    +       protected readonly CurrentCustomerUser $currentCustomerUser,
    ```
-   `transportsQuery()` method changed its interface:

    ```diff
    -    public function transportsQuery(): array
    -    public function transportsQuery(?string $cartUuid = null): array
    ```

-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework package:
    -   `Cart` properties (and all the related logic):
        -   `$promoCodes`
        -   `$transport`
        -   `$transportWatchedPrice`
        -   `$payment`
        -   `$paymentWatchedPrice`
        -   `$paymentGoPayBankSwift`
        -   `$pickupPlaceIdentifier`
    -   `CartItem::$uuid` property
    -   `Order` properties (and all the related logic):
        -   `$pickupPlaceIdentifier`
        -   `$trackingNumber`
    -   `Administrator::$transferIssuesLastSeen` property (and all the related logic)
    -   `Transport` properties (and all the related logic):
        -   `$trackingUrl`
        -   `$trackingInstruction`
        -   `$transportType`
        -   `$maxWeight`
    -   `Product::$weight` property (and all the related logic)
    -   `PromoCode` properties (and all the related logic):
        -   `$discountType`
        -   `$registeredOnly`
        -   `$domainId`
        -   `$datetimeValidFrom`
        -   `$datetimeValidTo`
        -   `$remainingUses`
        -   `$massGenerate`
        -   `$prefix`
        -   `$massGenerateBatchId`
    -   `PromoCodeBrand` entity (and all the related logic)
    -   `PromoCodeCategory` entity (and all the related logic)
    -   `PromoCodeProduct` entity (and all the related logic)
    -   `PromoCodeFlag` entity (and all the related logic)
    -   `PromoCodePricingGroup` entity (and all the related logic)
    -   `PromoCodeLimit` entity (and all the related logic)
    -   `Transfer` and `TransferIssue` entities (and all the related logic)
-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the frontend-api package:
    -   `CartMutation` and all the related logic
    -   `CartQuery` and all the related logic
    -   `CreateOrderMutation` and all the related logic
    -   see classes in the `Shopsys\FrontendApiBundle\Model\Cart` namespace
-   see #project-base-diff to update your project

#### fix issues reported by phpstan ([#3134](https://github.com/shopsys/shopsys/pull/3134))

-   see #project-base-diff to update your project

#### addProductToListMutation: ensure new product list is created with non-conflicting uuid ([#3126](https://github.com/shopsys/shopsys/pull/3126))

-   add new tests to `ProductListLoggedCustomerTest` and `ProductListNotLoggedCustomerTest` classes
-   see #project-base-diff to update your project

#### fix builds ([#3131](https://github.com/shopsys/shopsys/pull/3131))

-   see #project-base-diff to update your project

#### create order with preselected delivery address ([#3105](https://github.com/shopsys/shopsys/pull/3105))

-   `Shopsys\FrontendApiBundle\Model\Mutation\Order\CreateOrderMutation::VALIDATION_GROUP_DIFFERENT_DELIVERY_ADDRESS` constant was renamed to `VALIDATION_GROUP_DIFFERENT_DELIVERY_ADDRESS_WITHOUT_PRESELECTED`
-   see #project-base-diff to update your project

#### dispatch product stocks export after Setting::TRANSFER_DAYS_BETWEEN_STOCKS is set ([#3104](https://github.com/shopsys/shopsys/pull/3104))

-   `Shopsys\FrameworkBundle\Model\Stock\StockSettingsDataFacade::__construct` interface has changed:
    ```diff
        public function __construct(
            // ...
    +       protected readonly ProductRecalculationDispatcher $productRecalculationDispatcher,
    ```

#### remove unused operator info ([#3133](https://github.com/shopsys/shopsys/pull/3133))

-   see #project-base-diff to update your project

#### display error messages in admin if legal conditions articles are not set ([#3128](https://github.com/shopsys/shopsys/pull/3128))

-   `Shopsys\FrameworkBundle\Controller\Admin\DefaultController::__construct` interface has changed:

    ```diff
        public function __construct(
            // ...
    +       protected readonly Domain $domain,
    ```

-   see #project-base-diff to update your project

#### load products iteratively while generating image sitemaps ([#3144](https://github.com/shopsys/shopsys/pull/3144))

-   `Shopsys\FrameworkBundle\Model\Product\ProductRepository` class was changed:
    -   `getAllOfferedProducts()` method was removed, use `getAllOfferedProductsPaginated()` instead
-   see #project-base-diff to update your project

#### rename variable differentDeliveryAddress into isDeliveryAddressDifferentFromBilling ([#3161](https://github.com/shopsys/shopsys/pull/3161))

-   FE API: `OrderDecorator.types.yaml` and `OrderInputDecorator.types.yaml`: differentDeliveryAddress was renamed into more suitable isDeliveryAddressDifferentFromBilling
-   `Shopsys\FrontendApiBundle\Model\Mutation\Order\CreateOrderMutation::VALIDATION_GROUP_DIFFERENT_DELIVERY_ADDRESS_WITHOUT_PRESELECTED` constant was renamed to `VALIDATION_GROUP_IS_DELIVERY_ADDRESS_DIFFERENT_FROM_BILLING_WITHOUT_PRESELECTED`
-   see #project-base-diff to update your project

#### include domain sale exclusion in product querying more appropriately ([#3141](https://github.com/shopsys/shopsys/pull/3141))

-   `Shopsys\FrameworkBundle\Model\Product\ProductRepository::__construct` interface has changed:

    ```diff
        public function __construct(
            // ...
    +       protected readonly QueryBuilderExtender $queryBuilderExtender,
    ```

-   see #project-base-diff to update your project

#### add a way to use Blackfire profiling ([#3168](https://github.com/shopsys/shopsys/pull/3168))

-   see #project-base-diff to update your project

#### parameter data fixture refactoring ([#3170](https://github.com/shopsys/shopsys/pull/3170))

-   parameter and product parameter value definition in demo data is now simpler and more readable
-   demo data parameters are now created exclusively in ParameterDataFixture, and it is no longer possible to ad hoc create not existing parameter in ProductDataFixture when defining product parameter values
-   ParameterColorValueDataFixture is added to handle assigning hex values to color parameters
-   see #project-base-diff to update your project

#### refactor the place order process ([#3084](https://github.com/shopsys/shopsys/pull/3084))

-   see the specialized upgrade note in [upgrade-order-processing.md](./upgrade-order-processing.md)
-   see #project-base-diff to update your project

#### rename user-consent related code accordingly ([#3181](https://github.com/shopsys/shopsys/pull/3181))

-   setting values in DB was renamed from `cookiesArticleId` to `userConsentPolicyArticleId` (via migration `Version20240527121326`)
-   controller `Shopsys\FrameworkBundle\Controller\Admin\CookiesController` was renamed to `Shopsys\FrameworkBundle\Controller\Admin\UserConsentPolicyController`
    -   route `/cookies/setting/` (`admin_cookies_setting`) was changed to `/user-consent-policy/setting/` (`admin_userconsentpolicy_setting`)
    -   template `@ShopsysFramework/Admin/Content/Cookies/setting.html.twig` was moved to `@ShopsysFramework/Admin/Content/UserConsentPolicy/setting.html.twig`
-   form type `Shopsys\FrameworkBundle\Form\Admin\Cookies\CookiesSettingFormType` was renamed to `Shopsys\FrameworkBundle\Form\Admin\UserConsentPolicy\UserConsentPolicySettingFormType`
-   constant `Shopsys\FrameworkBundle\Component\Setting\Setting::COOKIES_ARTICLE_ID` was renamed to `Shopsys\FrameworkBundle\Component\Setting\Setting::USER_CONSENT_POLICY_ARTICLE_ID`
-   class `Shopsys\FrameworkBundle\Model\Cookies\CookiesFacade` was renamed to `Shopsys\FrameworkBundle\Model\UserConsentPolicy\UserConsentPolicyFacade`
    -   class no longer accepts `$environment` as a first argument in constructor
    -   method `isCookiesConsentGiven()` was removed without a replacement
    -   class is now strictly typed
-   class `Shopsys\FrameworkBundle\Twig\CookiesExtension` was removed
-   administrator roles `ROLE_COOKIES_FULL` and `ROLE_COOKIES_VIEW` were renamed to `ROLE_USER_CONSENT_POLICY_FULL` and `ROLE_USER_CONSENT_POLICY_VIEW`
    -   roles are renamed in migration `Version20240527121326`
-   graphql query `cookiesArticleQuery` was renamed to `userConsentPolicyArticleQuery`
    -   method `Shopsys\FrontendApiBundle\Model\Resolver\Article\ArticleQuery::cookiesArticleQuery` was renamed to `userConsentPolicyArticleQuery`
-   see #project-base-diff to update your project

#### fix search testing blog article demo data ([#3182](https://github.com/shopsys/shopsys/pull/3182))

-   see #project-base-diff to update your project

#### stop processing images by PHP to avoid decreasing quality ([#3169](https://github.com/shopsys/shopsys/pull/3169))

-   `Shopsys\FrameworkBundle\Component\Image\Processing\ImageProcessor` class was changed:
    -   all the methods and constants are now strictly typed
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        -        protected readonly ImageManager $imageManager,
                 protected readonly FilesystemOperator $filesystem,
        ```
    -   `createInterventionImage()` method was removed
    -   `resize()` method was removed
-   `Shopsys\FrameworkBundle\Component\Image\Processing\ImageThumbnailFactory` class was removed
-   `Shopsys\FrameworkBundle\Twig\FileThumbnail\FileThumbnailExtension` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        -        protected readonly ImageThumbnailFactory $imageThumbnailFactory,
        +        protected readonly ImageProcessor $imageProcessor,
        ```
    -   `DEFAULT_ICON_TYPE` constant is now strictly typed
    -   `IMAGE_THUMBNAIL_QUALITY` constant was removed
    -   all the methods are now strictly typed
-   `Shopsys\FrameworkBundle\Component\Domain\DomainFacade` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        -       $domainImagesDirectory,
        +       protected readonly string $domainImagesDirectory,
                protected readonly Domain $domain,
        -       protected readonly DomainIconResizer $domainIconResizer,
        -       FilesystemOperator $fileSystem,
        +       protected readonly DomainIconProcessor $domainIconProcessor,
        +       protected readonly FilesystemOperator $filesystem,
                protected readonly FileUpload $fileUpload,
        +       protected readonly ImageProcessor $imageProcessor,
        ```
    -   all the methods are now strictly typed
-   `Shopsys\FrameworkBundle\Component\Domain\DomainIconResizer` class was removed, use `Shopsys\FrameworkBundle\Component\Domain\DomainIconProcessor` instead
-   `Shopsys\FrameworkBundle\Component\Domain\DomainIconProcessor` class was changed:
    -   `convertToDomainIconFormatAndSave()` method was renamed to `saveIcon()`
-   `Shopsys\FrameworkBundle\Component\Image\Processing\Exception\OriginalSizeImageCannotBeGeneratedException` class was removed
-   `Shopsys\FrameworkBundle\Twig\ImageExtension` class was changed:
    -   `getImageUrl()` method changed its interface:
        ```diff
            public function getImageUrl(
                $imageOrEntity,
        -       ?string $type = null
        +       array $attributes
        ```
-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework package:
    -   `imageuploadFields.html.twig` Twig template extension
    -   `Advert/listGrid.html.twig` Twig template extension
-   see #project-base-diff to update your project

#### a little spring cleanup ([#3157](https://github.com/shopsys/shopsys/pull/3157))

-   `Shopsys\FrameworkBundle\Component\Error\ErrorPagesFacade` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly string $environment = EnvironmentType::PRODUCTION,
        ```
-   `Shopsys\FrameworkBundle\Controller\Admin\ArticleController` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly CleanStorefrontCacheFacade $cleanStorefrontCacheFacade,
        ```
-   `Shopsys\FrameworkBundle\Model\Product\BestsellingProduct\CachedBestsellingProductFacade` class was changed:
    -   `getAllOfferedBestsellingProducts()` method was removed, use `CachedBestsellingProductFacade::getAllOfferedBestsellingProductIds()` instead
    -   `getSortedProducts()` method was removed without replacement
-   `Shopsys\FrameworkBundle\Twig\LocalizationExtension` class was changed:
    -   `getLocaleFlagHtml()` method changed its interface:
        ```diff
        -   getLocaleFlagHtml($locale, $showTitle = true)
        +   getLocaleFlagHtml(string $locale, bool $showTitle = true, int $width = 16, int $height = 11): string
        ```
-   `Shopsys\FrameworkBundle\Twig\PriceExtension` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly AdminDomainTabsFacade $adminDomainTabsFacade,
        ```
-   `Shopsys\FrameworkBundle\Component\HttpFoundation\TransactionalMasterRequestListener` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        +       protected readonly Traversable $transactionalMasterRequestConditionProviders,
                protected readonly EntityManagerInterface $em,
        ```
-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework package:
    -   `FormBuilderHelper` class
    -   `ArrayWithPaginationDataSource` class
    -   `LocaleHelper` class
    -   `DomainController::localeTabsAction()` method
    -   `RedisController` class
    -   `UploadedFileController` class
    -   `CsrfExtension` class
-   see #project-base-diff to update your project

#### update easy-coding-standard to version 12.2 ([#3192](https://github.com/shopsys/shopsys/pull/3192))

-   update configuration file to new version
-   skip rules are now defined in the separate `ecs-skip-rule.php` file
-   paths to check are now defined directly in the `ecs.php` file
-   fixer `RedundantMarkDownTrailingSpacesFixer` was removed as markdown files are formatted by prettier
-   see #project-base-diff to update your project

#### fix VatDeletionCronModule ([#3195](https://github.com/shopsys/shopsys/pull/3195))

-   `Shopsys\FrameworkBundle\Model\Product\Pricing\ProductInputPriceRecalculator` class was removed
-   `Shopsys\FrameworkBundle\Model\Product\Pricing\ProductInputPriceFacade` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
                protected readonly ProductRepository $productRepository,
        -       protected readonly ProductInputPriceRecalculator $productInputPriceRecalculator,
                protected readonly ProductRecalculationDispatcher $productRecalculationDispatcher,
        ```
    -   the class is now strictly typed
-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework package:
    -   `ProductInputPriceFacade::replaceBatchVatAndRecalculateInputPrices()` logic
    -   `Product::getProductDomains()` method
-   see #project-base-diff to update your project

#### improve OrderSequence related types ([#3206](https://github.com/shopsys/shopsys/pull/3206))

-   class `Shopsys\FrameworkBundle\Model\Order\OrderNumberSequenceFactory` was removed
-   interface `Shopsys\FrameworkBundle\Model\Order\OrderNumberSequenceFactoryInterface` was removed
-   method `Shopsys\FrameworkBundle\Model\Order\OrderNumberSequenceRepository::getNextNumber()` now returns `string`
-   class `Shopsys\FrameworkBundle\Model\Order\OrderNumberSequenceRepository` is now strictly typed
-   see #project-base-diff to update your project

#### minor improvements related to deployment ([#3201](https://github.com/shopsys/shopsys/pull/3201))

-   not used database tables `advert_category` and `entity` were removed in migration `Version20240604152553`
-   update `shopsys/deployment` package to a new major version
-   see #project-base-diff to update your project

#### add nominal promo code to demo data ([#3197](https://github.com/shopsys/shopsys/pull/3197))

-   see #project-base-diff to update your project

#### product data fixture refactoring ([#3187](https://github.com/shopsys/shopsys/pull/3187))

-   There was some unnecessary repeating in product data fixtures - it is now simplified in places where it made sense for project base purposes.
-   `ProductDemoDataFactory` class was added as a foundation for creating demo data templates for certain groups of products that has a lot of common data which is not very applicable for project base demo data but could be in real projects.

#### implemented registration and login via social networks ([#3154](https://github.com/shopsys/shopsys/pull/3154))

-   implemented are login via Facebook, Google, and Seznam
-   add url `{eshop_domain}/social-network/login/{type}` as redirect url in you social network. `type` is implemented service e.g.: `google`, `facebook`, `seznam`
-   `Shopsys\FrameworkBundle\Model\Administrator\Security\AdministratorFrontSecurityFacade::isAdministratorLoggedAsCustomer()` method was removed
-   `Shopsys\FrameworkBundle\Controller\Admin\AdministratorController` constructor was changed:
    ```diff
        public function __construct(
            // ...
    +       protected readonly AdministratorTwoFactorAuthenticationFacade $administratorTwoFactorAuthenticationFacade,
    ```
-   `Shopsys\FrameworkBundle\Controller\Admin\CustomerController` class was changed:
    -   `__construct()` method changed its interface:
    ```diff
        public function __construct(
            // ...
            protected readonly OrderFacade $orderFacade,
    -       protected readonly LoginAsUserFacade $loginAsUserFacade,
            protected readonly DomainRouterFactory $domainRouterFactory,
            // ...
    +       protected readonly LoginAdministratorAsUserUrlProvider $loginAdministratorAsUserUrlProvider,
    ```
    -   `LOGIN_AS_TOKEN_ID_PREFIX` constant was removed
    -   `loginAsUserAction()` method was removed, use `Shopsys\FrontendApiBundle\Controller\CustomerUserController::loginAsCustomerUserAction()` instead
    -   `getSsoLoginAsCustomerUserUrl()` method was removed, use `Shopsys\FrontendApiBundle\Model\Security\LoginAdministratorAsUserUrlProvider::getSsoLoginAsCustomerUserUrl()` instead
-   `Shopsys\FrameworkBundle\Model\Administrator\Administrator` class was changed:
    -   the class now implements `Scheb\TwoFactorBundle\Model\Email\TwoFactorInterface` and `Scheb\TwoFactorBundle\Model\Google\TwoFactorInterface`
    -   `checkRolesContainAdminRole()` method was removed
-   `Shopsys\FrameworkBundle\Model\Customer\Mail\CustomerMailFacade` constructor was changed:
    ```diff
        public function __construct(
            // ...
    +       protected readonly CustomerActivationMail $customerActivationMail,
    ```
-   `Shopsys\FrameworkBundle\Model\Customer\User\CustomerUserFacade` class was changed:
    -   `__construct()` changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly NewsletterFacade $newsletterFacade,
        +       protected readonly HashGenerator $hashGenerator,
        ```
    -   `edit()` function is now public
    -   `addRefreshTokenChain()` method changed its interface:
        ```diff
            public function addRefreshTokenChain(
                // ...
        +       ?Administrator $administrator,
        ```
-   `Shopsys\FrameworkBundle\Model\Customer\User\CustomerUserRefreshTokenChainFacade` class was changed:
    -   `createCustomerUserRefreshTokenChain()` method changed its interface:
        ```diff
            public function createCustomerUserRefreshTokenChain(
                // ...
        +       ?Administrator $administrator,
        ```
    -   `findCustomersTokenChainByCustomerUserAndSecretChain()` method was removed, use `findCustomersTokenChainByCustomerUserAndSecretChainAndDeviceId()` instead
-   `Shopsys\FrameworkBundle\Model\Mail\MailTemplateFacade` class was changed:
    -   `__construct()` changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly MailTemplateBuilder $mailTemplateBuilder,
        ```
-   `Shopsys\FrameworkBundle\Model\Mail\MailTemplateRepository` class was changed:
    -   `__construct()` changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly Localization $localization,
        ```
-   `Shopsys\FrontendApiBundle\Model\Mutation\Login\LoginMutation` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly MergeCartFacade $mergeCartFacade,
        +       protected readonly TokensDataFactory $tokensDataFactory,
        +       protected readonly LoginResultDataFactory $loginResultDataFactory,
        ```
    -   `loginMutation()` method now returns an instance of `LoginResultData`
-   `Shopsys\FrontendApiBundle\Model\Mutation\Customer\User\CustomerUserMutation` class was changed:
    -   `__contsruct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly RegistrationFacade $registrationFacade,
        +       protected readonly RegistrationDataFactory $registrationDataFactory,
        +       protected readonly MergeCartFacade $mergeCartFacade,
        +       protected readonly OrderApiFacade $orderFacade,
        +       protected readonly LoginResultDataFactory $loginResultDataFactory,
        +       protected readonly TokensDataFactory $tokensDataFactory,
        ```
    -   `registerMutation()` now returns an instance of `LoginResultData`
-   `Shopsys\FrontendApiBundle\Model\Mutation\Login\RefreshTokensMutation` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                // ...
        +       protected readonly TokensDataFactory $tokensDataFactory,
        ```
    -   `refreshTokensMutation()` now returns an instance of `TokensData`
-   `Shopsys\FrontendApiBundle\Model\Order\OrderApiFacade::__construct()` changed its interface:
    ```diff
        public function __construct(
            // ...
    +       protected readonly EntityManagerInterface $em,
    ```
-   `Shopsys\FrontendApiBundle\Model\Token\TokenFacade` clas was changed:
    -   `createAccessTokenAsString()` method changed its interface:
        ```diff
            public function createAccessTokenAsString(
                // ...
        +       ?Administrator $administrator = null,
        ```
    -   `createRefreshTokenAsString()` method changed its interface:
        ```diff
            public function createRefreshTokenAsString(
                // ...
        +       ?Administrator $administrator = null,
        ```
    -   `generateRefreshTokenByCustomerUserAndSecretChain()` method was removed, use `generateRefreshTokenByCustomerUserAndSecretChainAndDeviceId()` instead
-   `Shopsys\FrontendApiBundle\Model\User\FrontendApiUser::__construct()` changed its interface:
    ```diff
        public function __construct(
            // ...
    +       protected readonly ?string $administratorUuid,
    ```
-   `Shopsys\FrameworkBundle\Model\Security\LoginAsUserFacade` was removed, use `Shopsys\FrontendApiBundle\Model\Security\LoginAsUserFacade` instead
-   `Shopsys\FrontendApiBundle\Model\Customer\User\CustomerUserUpdateDataFactory::__construct()` changed its interface:

    ```diff
         public function __construct(
            protected readonly CustomerUserUpdateDataFactoryInterface $customerUserUpdateDataFactory,
    +       protected readonly BillingAddressDataFactory $billingAddressDataFactory,
    +       protected readonly \Shopsys\FrameworkBundle\Model\Customer\User\CustomerUserDataFactory $customerUserDataFactory,
    ```

-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework package:
    -   `AdministratorRoleGroup` entity, `Administrator::$roleGroup` and all the related logic
    -   `Roles`, `RolesType`, `MenuItemsGrantedRolesSetting`, and all the related logic
        -   removing not granted items from the menu is now moved from `SideMenuConfigurationSubscriber` to the new `MenuItemsGrantedRolesSubscriber` class
    -   `Administrator::$uuid` property
    -   `Administrator` two factor authentication feature
    -   not nullable setting for `BillingAddress` properties `$street`, `$city`, `$postcode`, and `$country`
    -   `BillingAddress::$activated` property and all the related logic
    -   `DeliveryAddress::$uuid` property and all the related logic
    -   `CustomerUser::$newsletterSubscription` and all the related logic
    -   `CustomerUserRefreshTokenChain::$administrator`
    -   `RemoveOldCustomerUserRefreshTokenChainsCronModule` and all the related logic
    -   `CustomerUserUpdateDataFactory::createAmendedByOrder()`
    -   `MailTemplate::$orderStatus` property and all the related logic
    -   `MailTemplateBuilder` class
    -   `MailSetting` class constants `MAIL_FACEBOOK_URL`, `MAIL_INSTAGRAM_URL`, `MAIL_YOUTUBE_URL`, `MAIL_LINKEDIN_URL`, `MAIL_TIKTOK_URL`, and `MAIL_FOOTER_TEXT` and all the related logic
    -   `Order::setCustomerUser()` method
-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the frontend-api package:
    -   `CustomerController::loginAsCustomerUserAction()` and all the related logic
        -   `Shopsys\FrontendApiBundle\Model\Security\LoginAsUserFacade`
        -   `admin_customer_loginascustomeruser` route was renamed to `admin_customeruser_loginascustomeruser`
    -   `CustomerUserUpdateDataFactory::createFromRegistrationData()`
    -   `OrderApiFacade::ONE_HOUR_REGISTRATION_WINDOW` constant
    -   `OrderApiFacade` methods:
        -   `getByOrderNumberAndCustomerUser()`
        -   `findLastOrderByCustomerUser()`
        -   `pairCustomerUserWithOrderByOrderUuid()`
    -   `OrderRepository` methods:
        -   `getByOrderNumberAndCustomerUser()`
        -   `findByOrderNumberAndCustomerUser()`
        -   `getByUuidAndCustomerUser()`
    -   `RegistrationData` class
    -   `RegistrationDataFactory` class
    -   `RegistrationFacade` class
    -   `TokenAuthenticator::HEADER_AUTHORIZATION` constant
    -   `TokenAuthenticator` methods:
        -   `getCredentials()`
        -   `onAuthenticationFailure()`
    -   `TokenFacade` methods:
        -   `createAccessTokenAsString()`
        -   `createRefreshTokenAsString()`
        -   `generateRefreshTokenByCustomerUserAndSecretChainAndDeviceId()`
    -   `CustomerUserMutation` methods:
        -   `registerMutation()`
        -   `changePersonalDataMutation()`
        -   `computeValidationGroups()`
    -   `RefreshTokensMutation::refreshTokensMutation()`
    -   `CustomerUserRefreshTokenChainFacade` methods:
        -   `findCustomersTokenChainByCustomerUserAndSecretChainAndDeviceId()`
        -   `removeCustomerRefreshTokenChain()`
    -   `FrontendApiUser::CLAIM_ADMINISTRATOR_UUID` constant
    -   `FrontendApiUser::$administratorUuid` property
    -   `LoginMutation::loginWithResultMutation()` logic was moved into `LoginMutation::loginMutation()`
    -   `CustomerUserResolverMap`
    -   `CompanyCustomerUser`, `RegularCustomerUser` graphql types
    -   `CurrentCustomerUser` graphql type fields: `street`, `city`, `postcode`, `country`, `defaultDeliveryAddress`, `deliveryAddresses`, and `pricingGroup`
-   see #project-base-diff to update your project

#### move navigation feature from project-base to the packages ([#3218](https://github.com/shopsys/shopsys/pull/3218))

-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework and frontend-api packages:
    -   `NavigationItem` entity and all the related logic
    -   `NavigationQuery`
    -   see #project-base-diff to update your project

#### change free transport limit in demo data ([#3199](https://github.com/shopsys/shopsys/pull/3199))

-   see #project-base-diff to update your project

#### add packeta type transport to demo data ([#3198](https://github.com/shopsys/shopsys/pull/3198))

-   see #project-base-diff to update your project

#### fix Luigi's Box filters might miss already selected parameters ([#3220](https://github.com/shopsys/shopsys/pull/3220))

-   `\Shopsys\LuigisBoxBundle\Model\Batch\LuigisBoxBatchLoadDataFactory` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                protected readonly ProductFilterToLuigisBoxFilterMapper $productFilterToLuigisBoxFilterMapper,
                protected readonly TypeInLuigisBoxEnum $typeInLuigisBoxEnum,
                protected readonly RecommendationTypeEnum $recommendationTypeEnum,
        +       protected readonly FacetFactory $facetFactory,
        +       protected readonly ParameterFacade $parameterFacade,
            ) {
        ```
    -   `createForSearch()` method changed its interface:
        ```diff
            public function createForSearch(
                string $type,
                int $limit,
                int $page,
                Argument $argument,
                array $luigisBoxFilter = [],
        +       array $facetNames = [],
            ): LuigisBoxBatchLoadData {
        ```
    -   `getFacetNamesByType()` method has been replaced by `\Shopsys\LuigisBoxBundle\Model\Facet\FacetFactory::getDefaultFacetNamesByType()`
-   `\Shopsys\LuigisBoxBundle\Model\Product\ProductSearchResultsProvider` class was changed:

    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                string $enabledDomainIds,
                protected readonly ProductConnectionFactory $productConnectionFactory,
                protected readonly LuigisBoxClient $client,
                protected readonly Domain $domain,
                protected readonly ProductFilterToLuigisBoxFilterMapper $productFilterToLuigisBoxFilterMapper,
                protected readonly DataLoaderInterface $luigisBoxBatchLoader,
                protected readonly LuigisBoxBatchLoadDataFactory $luigisBoxBatchLoadDataFactory,
                protected readonly ProductFilterDataMapper $productFilterDataMapper,
        +       protected readonly FacetFactory $facetFactory,
            ) {
        ```

-   see #project-base-diff to update your project

#### removed ReadyCategorySeoMixDataForForm ([#3214](https://github.com/shopsys/shopsys/pull/3214))

-   see #project-base-diff to update your project

#### update composer dependencies to newer versions ([#3213](https://github.com/shopsys/shopsys/pull/3213))

-   PHPUnit has been updated to version 11 with many other dependencies
    -   many changes have been introduced since previously used version 9 e.g. configuration options, deprecated or removed methods, deprecated doc-blocks, etc.
    -   see https://github.com/sebastianbergmann/phpunit/blob/11.1/DEPRECATIONS.md and https://github.com/sebastianbergmann/phpunit/blob/10.5/DEPRECATIONS.md for deprecations in PHPUnit that you need to solve in your tests
    -   see #project-base diff to see changes you might need to apply in your tests
-   `commerceguys/intl` has been updated to the latest version
    -   `IntlCurrencyRepository` and `NumberFormatterExtension` class methods have updated their interfaces to include strict types, you will need to update your usages of such methods in your project
    -   `Phing` is no longer direct dependency, but is downloaded separately via `php project-base/app/app/downloadPhing.php` command. This is done directly in `composer.json` file, so you should follow changes in project-base to update `composer.json`, `phing` and other files accordingly
-   see #project-base-diff to update your project

#### all Shopsys packages are included in ClassExtensionRegistry so annotation fixer now works for all Shopsys packages ([#3230](https://github.com/shopsys/shopsys/pull/3230))

-   `Shopsys\FrameworkBundle\Command\ExtendedClassesAnnotationsCommand` class was changed:
    -   method `replaceFrameworkWithProjectAnnotations()` renamed to `replaceShopsysWithProjectAnnotations()`
-   `Shopsys\FrameworkBundle\Component\ClassExtension\ClassExtensionRegistry` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        -       protected readonly string $frameworkRootDir,
        -       protected readonly array $entityExtensionMap = [],
        +       protected readonly array $entityExtensionMap,
        +       protected readonly array $packagesRegistry,
            ) {
        ```
    -   run `php phing annotations-fix` to apply changes in your project
-   see #project-base-diff to update your project

#### move part of the parameter and filters functionality from project-base to framework and frontend-api packages ([#3221](https://github.com/shopsys/shopsys/pull/3221))

-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the framework and frontend-api packages:
    -   `Parameter` properties (and all the related logic):
        -   `$parameterType`
        -   `$orderingPriority`
        -   `$unit`
    -   `ParameterValue` properties (and all the related logic):
        -   `$rgbHex`
        -   `$colourIcon`
        -   `$unit`
        -   `$text` is now text instead of string(100)
-   `Shopsys\FrameworkBundle\Model\Product\Filter\ParameterFilterChoice` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        -       ?Parameter $parameter = null,
        +       protected readonly Parameter $parameter,
                protected readonly array $values = [],
            ) {
        ```
-   `Shopsys\FrameworkBundle\Model\Product\Filter\ParameterFilterChoice` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                protected readonly EntityManagerInterface $em,
                protected readonly ParameterRepository $parameterRepository,
                protected readonly ParameterFactoryInterface $parameterFactory,
                protected readonly EventDispatcherInterface $eventDispatcher,
                protected readonly CategoryParameterRepository $categoryParameterRepository,
        +       protected readonly UploadedFileFacade $uploadedFileFacade,
            ) {
        ```
-   `Shopsys\FrontendApiBundle\Model\Product\Filter\FlagFilterOption` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                public readonly Flag $flag,
                public readonly int $count,
                public readonly bool $isAbsolute,
        +       public bool $isSelected,
            ) {
        ```
-   `Shopsys\FrontendApiBundle\Model\Product\Filter\ParameterFilterOption` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                public readonly Parameter $parameter,
                public readonly array $values,
            +   public bool $isCollapsed,
            +   public bool $isSelectable,
            +   public ?float $selectedValue = null,
            ) {
        ```
-   `Shopsys\FrontendApiBundle\Model\Product\Filter\ParameterFilterOption` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
        -       ParameterValue $parameterValue,
        +       public readonly ParameterValue $parameterValue,
                public readonly int $count,
                public readonly bool $isAbsolute,
        +       public readonly bool $isSelected,
            ) {
        ```
-   `Shopsys\FrontendApiBundle\Model\Product\Filter\ProductFilterOptionsFactory` class was changed:
    -   `__construct()` method changed its interface:
        ```diff
            public function __construct(
                protected readonly ModuleFacade $moduleFacade,
        -       ProductOnCurrentDomainElasticFacade $productOnCurrentDomainFacade,
        +       protected readonly ProductOnCurrentDomainElasticFacade $productOnCurrentDomainElasticFacade,
            ) {
        ```
    -   `createFlagFilterOption()` method changed its interface:
        ```diff
            protected function createFlagFilterOption(
                Flag $flag,
                int $count,
                bool $isAbsolute,
        +       bool $isSelected = false,
            ): FlagFilterOption {
        ```
    -   `createParameterFilterOption()` method changed its interface:
        ```diff
            protected function createParameterFilterOption(
                Parameter $parameter,
                array $parameterValueFilterOptions,
        +       bool $collapsed,
        +       bool $isSliderAllowed,
        +       ?float $selectedValue = null,
            ): ParameterFilterOption {
        ```
    -   `createParameterFilterOption()` method changed its interface:
        ```diff
            protected function createParameterValueFilterOption(
                ParameterValue $brand,
                int $count,
                bool $isAbsolute,
        +       bool $isSelected = false,
            ): ParameterValueFilterOption {
        ```
    -   after these manual changes run `composer install`, `php phing standards-fix` and `php phing phpstan` commands, which will probably fail on errors caused by incompatibility strict types, if so fix them manually
    -   see #project-base-diff to update your project

#### move features from project-base to the packages ([#3210](https://github.com/shopsys/shopsys/pull/3210))

-   [features moved](#movement-of-features-from-project-base-to-packages) from project-base to the frontend-api package:
    -   `Order::$gtmCoupon` (renamed to `Order::$promoCode`)
    -   `CategoriesBatchLoader`
    -   `ContactFormMutation` and related graphql types
        -   `ContactInput` was renamed to `ContactFormInput`
        -   `Contact` mutation was renamed to `ContactForm`
    -   `CountriesQuery` and `Country` graphql type
    -   `File` graphql type
    -   `Payment::mainImage` and `Payment::type` graphql fields
    -   `AdvertImage::mainImage` graphql field
    -   `PriceInterface` graphql type was removed
-   see #project-base-diff to update your project

#### resolve some deprecations to prepare for easier upgrade to Symfony 6 ([#3209](https://github.com/shopsys/shopsys/pull/3209))

-   `nyholm/psr7` package was removed from the project
-   `sensio/framework-extra-bundle` package was removed from the project
-   the description of every Symfony command is now defined in the attribute `#[AsCommand]` instead of the `configure()` method
-   the `@Route` annotation in the Admin controllers was replaced with the `#[Route]` attribute
-   the method `Shopsys\FormTypesBundle\YesNoType::getParent()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Component\AnnotatedRouteControllerLoader::getDefaultRouteName()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Component\Domain\Config\DomainsConfigDefinition::getConfigTreeBuilder()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Component\Domain\Config\DomainsUrlsConfigDefinition::getConfigTreeBuilder()` is now strictly typed
-   the constructor of `Shopsys\FrameworkBundle\Component\Domain\DomainIconProcessor` accepts `Monolog\Logger` as a first argument instead of `\Symfony\Bridge\Monolog\Logger`
-   the method `Shopsys\FrameworkBundle\Component\Image\Config\ImageConfigDefinition::getConfigTreeBuilder()` is now strictly typed
-   the class `Shopsys\FrameworkBundle\Component\Router\CurrentDomainRouter` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Component\Router\CurrentDomainRouter::setContext()` is now strictly typed
-   the class `Shopsys\FrameworkBundle\Component\Translation\CustomTransFiltersVisitor` no longer extends `AbstractNodeVisitor`, but implements `NodeVisitorInterface` instead
-   the class `Shopsys\FrameworkBundle\Component\Translation\Translator` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Component\UploadedFile\Config\UploadedFileConfigDefinition::getConfigTreeBuilder()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Form\Admin\Login\LoginFormType::getBlockPrefix()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Form\DisplayVariablesType::getParent()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Form\GrapesJsType::getParent()` is now strictly typed
-   the class `Shopsys\FrameworkBundle\Form\Transformers\MailWhitelistTransformer` is now strictly typed
-   the class `Shopsys\FrameworkBundle\Form\Transformers\WysiwygCdnDataTransformer` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Administrator\Administrator::getRoles()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Administrator\Security\AdministratorUserProvider::refreshUser()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Administrator\Security\AdministratorUserProvider::supportsClass()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Customer\User\FrontendCustomerUserProvider::refreshUser()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Customer\User\FrontendCustomerUserProvider::supportsClass()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Product\ProductBreadcrumbGenerator::getBreadcrumbItems()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Security\CustomerLoginHandler::onAuthenticationSuccess()` is now strictly typed
-   the method `Shopsys\FrameworkBundle\Model\Security\CustomerLoginHandler::onAuthenticationFailure()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\DeliveryAddressUuid::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\PaymentInCart::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\PaymentInExistingOrder::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\PaymentInOrder::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\ProductInOrder::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\PromoCode::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\TransportInCart::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Component\Constraints\TransportInOrder::getTargets()` is now strictly typed
-   the method `Shopsys\FrontendApiBundle\Model\Resolver\Order\OrdersQuery::ordersQuery()` is now strictly typed
-   you may simplify the [upgrade of your project with Rector](https://docs.shopsys.com/en/15.0/project/upgrade-your-project-with-rector/)
-   see #project-base-diff to update your project
